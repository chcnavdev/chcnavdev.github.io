接收坐标的先期准备： 连接RTK卫星接收机，按电源键将卫星接收机开机，打开测地通软件，确认软件在合法并注册的前提下使用，注意，没有工程需要创建工程或打开已有工程。

## 连接RTK

测地通软件通过（蓝牙/Wifi方式）方式或通过本地连接，连接到数据发生源。切换到配置页面，点击连接菜单或直接点击顶部连接到设备导航栏，进入连接仪器界面如下图。打开蓝牙搜索目标设备，选择后并点击连接按钮。

![image-20250427140236181](https://blog-1256273063.cos.ap-nanjing.myqcloud.com/image-20250427140236181.png)

## 配置CORS

在测地通软件配置页面，找到移动站设置输入Cors账号为定位模块提供差分数据，应用后使之固定。

![image-20250427140213393](https://blog-1256273063.cos.ap-nanjing.myqcloud.com/image-20250427140213393.png)

## 配置广播消息

点击用户头像或右滑进入侧滑菜单，选择软件设置功能，在软件设置界面点击二次开发按钮，打开二次开发界面，在二次开发界面打开通过Android广播消息传递实时坐标的开关，至此测地通软件设置完毕，测地通软件开始通过Android广播向外播发实时高精度位置坐标。

![image-20250427140310423](https://blog-1256273063.cos.ap-nanjing.myqcloud.com/image-20250427140310423.png)

## 接收广播消息

Android第三方软件接收坐标的实现方法：注册测地通软件发送的位置广播并接收传递出来的位置数据，具体代码可参考下面

```java
public class ReceiveLocationBroadcastReceiver extends BroadcastReceiver {
    public static final String LOCATION_INFO_INTENT = "com.huace.landstar.api.action";
    public static final String KEY_LOCATION_FIFO = "location";
    private final StringBuffer mStringBuffer;
    public ReceiveLocationBroadcastReceiver() {
        mStringBuffer = new StringBuffer();
    }  
    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent != null && intent.getAction().equals(LOCATION_INFO_INTENT)) {
            Location location = intent.getParcelableExtra(KEY_LOCATION_FIFO);
            if (location != null) {
                mStringBuffer.delete(0, mStringBuffer.length());
                mStringBuffer.append("Location[").append("<br>");
                mStringBuffer.append("Provider = ").append(location.getProvider()).append(",").append("<br>");
                double latitude = Math.toDegrees(location.getLatitude());
                mStringBuffer.append("B = ").append(latitude).append(",").append("<br>");
                double longitude = Math.toDegrees(location.getLongitude());
                mStringBuffer.append("L = ").append(longitude).append(",").append("<br>");
                mStringBuffer.append("H = ").append(location.getAltitude()).append(",").append("<br>");
                mStringBuffer.append("HPre = ").append(location.getAccuracy()).append(",").append("<br>");
                //板卡解算状态-1:搜星中 0:单点  1:SBAS 2:浮动 3:固定 4: 伪距差分
                mStringBuffer.append("solve_status= ").append(location.getExtras().get("solve_status")).append(",").append("<br>");
                mStringBuffer.append("x_precision= ").append(location.getExtras().get("x_precision")).append(",").append("<br>");
                mStringBuffer.append("y_precision= ").append(location.getExtras().get("y_precision")).append(",").append("<br>");
                mStringBuffer.append("h_precision= ").append(location.getExtras().get("h_precision")).append(",").append("<br>");
                mStringBuffer.append("key_neh_n= ").append(location.getExtras().get("key_neh_n")).append(",").append("<br>");
                mStringBuffer.append("key_neh_e= ").append(location.getExtras().get("key_neh_e")).append(",").append("<br>");
                mStringBuffer.append("key_neh_h= ").append(location.getExtras().get("key_neh_h")).append(",").append("<br>");
                Log.d("TAG","LocationInfo: "+mStringBuffer.toString());
            }
        }
    }
}
```

